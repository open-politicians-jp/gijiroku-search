# 📊 自動データ収集スケジュール

## Cron設定

### 🕐 実行スケジュール
```yaml
schedule:
  # 毎日午前3時（JST）に実行（UTC 18:00）
  - cron: '0 18 * * *'
```

- **実行時間**: 毎日午前3時（JST）
- **UTC時間**: 18:00（日本時間 - 9時間）
- **実行頻度**: 毎日自動実行

### 🎯 収集対象データ

#### 自動収集（毎日）
1. **📊 議事録データ** (`daily_data_collection.py`)
   - 国会会議録検索API
   - 過去2ヶ月分

2. **📋 質問主意書** (`collect_questions_fixed.py`)
   - 衆議院・参議院公式サイト
   - HTML/PDFリンク付き

3. **📜 提出法案** (`collect_bills_fixed.py`)
   - 各院公式サイト
   - ステータス・審議状況

4. **📰 委員会ニュース** (`collect_committee_news_fixed.py`)
   - 委員会活動情報

5. **📄 マニフェスト** (`collect_real_manifestos.py`)
   - 主要7政党公式サイト

#### 自動処理（収集後）
- **🔧 大きなファイル分割**: GitHub制限対応
- **📝 週次データ整理**: 週単位での統合
- **🔗 リンク修正**: 相対URL→絶対URL変換

## 手動実行オプション

### 🎛️ 実行パラメータ

#### 対象スクリプト選択
```
all         - すべてのスクリプト実行（デフォルト）
speeches    - 議事録のみ
questions   - 質問主意書のみ
bills       - 提出法案のみ
committee   - 委員会ニュースのみ
manifestos  - マニフェストのみ
```

#### 収集期間設定
```
months_back: '2'    - 過去2ヶ月（デフォルト）
months_back: '6'    - 過去6ヶ月
months_back: '12'   - 過去1年
```

#### 強制更新
```
force_update: false - 増分更新（デフォルト）
force_update: true  - 全データ再収集
```

### 🚀 手動実行手順

1. **GitHub リポジトリ** → **Actions**
2. **📊 自動データ収集** を選択
3. **Run workflow** をクリック
4. パラメータを設定（オプション）
5. **Run workflow** で実行

## 実行結果

### ✅ 成功時の動作
1. データ収集・処理完了
2. `frontend/public/data/` に新データ保存
3. 自動コミット・プッシュ
4. GitHub Pagesデプロイトリガー
5. サイト自動更新

### ❌ エラー時の対応
1. **Actions** タブでログ確認
2. エラー内容に応じて対処：
   - API制限: 時間をおいて再実行
   - サイト変更: スクリプト修正
   - ネットワークエラー: 再実行

### 📊 実行サマリー
各実行後に以下の情報を表示：
- 実行時刻・対象スクリプト
- 収集データ件数
- 成功/失敗ステータス

## 監視とメンテナンス

### 📈 定期チェック項目

#### 毎週確認
- [ ] データ収集成功率
- [ ] 新データファイル生成確認
- [ ] サイト動作確認

#### 毎月確認
- [ ] ファイルサイズ制限チェック
- [ ] データ品質確認
- [ ] スクリプト動作確認

### 🛠️ トラブルシューティング

#### よくある問題
1. **API制限エラー**
   - 対処: 収集間隔調整、リクエスト数削減

2. **サイト構造変更**
   - 対処: スクリピング対象サイトの構造確認・修正

3. **ファイルサイズ超過**
   - 対処: 分割スクリプト改善、データ期間短縮

4. **ネットワークタイムアウト**
   - 対処: タイムアウト時間延長、リトライ機能追加

### 🔧 設定調整

#### 実行頻度変更
```yaml
# 週1回実行（月曜日午前3時）
- cron: '0 18 * * 1'

# 1日2回実行（午前3時・午後3時）
- cron: '0 18,6 * * *'
```

#### 収集対象調整
特定のスクリプトを無効化：
```yaml
- name: 📄 マニフェスト収集
  if: false  # 無効化
```

## GitHub Actions制限

### 無料プラン制限
- **実行時間**: 月2,000分（プライベート）
- **ストレージ**: 500MB
- **同時実行**: 20ジョブ

### 最適化設定
- キャッシュ使用でUV環境構築高速化
- エラー時の早期終了設定
- 条件分岐で不要処理スキップ

これで、毎日自動でデータが更新され、常に最新の政治情報を提供できるシステムが構築されています。